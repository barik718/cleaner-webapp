<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–í—ã—Ö–æ–¥ –Ω–∞ —Ä–∞–±–æ—Ç—É</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Telegram WebApp SDK -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body style="font-family: Arial; text-align: center; padding: 40px;">

<h2>–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ üëã</h2>
<p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –æ—Ç–º–µ—Ç–∏—Ç—å –≤—ã—Ö–æ–¥ –Ω–∞ —Ä–∞–±–æ—Ç—É</p>

<button
onclick="mark()"
style="
font-size: 20px;
padding: 15px 30px;
border-radius: 10px;
background: #2ea44f;
color: white;
border: none;
cursor: pointer;
"
>
–Ø –≤—ã—à–µ–ª
</button>

<script>
const tg = window.Telegram.WebApp;
tg.ready();

function mark() {
alert("mark –≤—ã–∑–≤–∞–Ω"); // üî¥ –®–ê–ì 1: –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

const user = tg.initDataUnsafe.user;

if (!user) {
alert("‚ùå user = null. –û—Ç–∫—Ä–æ–π—Ç–µ WebApp —á–µ—Ä–µ–∑ Telegram!");
return;
}

alert(
"–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ:\n" +
"id: " + user.id + "\n" +
"name: " + user.first_name
);

fetch("https://script.google.com/macros/s/AKfycbyDiadNgwE6EaJhi6uDMlN7g1-atSdvTQ4fhjVN9M7kowjXQm2yNB0_Zf2HpFahOeeNeg/exec", {
method: "POST",
headers: {
"Content-Type": "application/json"
},
body: JSON.stringify({
id: user.id,
name: user.first_name,
username: user.username
})
})
.then(response => {
alert("‚úÖ fetch –≤—ã–ø–æ–ª–Ω–µ–Ω, —Å—Ç–∞—Ç—É—Å: " + response.status);
tg.close(); // üî¥ –ó–ê–ö–†–´–í–ê–ï–ú –¢–û–õ–¨–ö–û –ü–û–°–õ–ï –£–°–ü–ï–®–ù–û–ì–û FETCH
})
.catch(error => {
alert("‚ùå –û—à–∏–±–∫–∞ fetch");
console.error(error);
});
}
</script>

</body>
</html>
